<article itemscope itemtype="http://schema.org/BlogPosting"
  role="article" class="post-item {{post_class}}">
  <header class="post-item-header">
    <h2 itemprop="name" class="post-item-title">
      <a href="{{url}}" itemprop="url" data-pjax title="{{{title}}}">
        {{{title}}}
      </a>
    </h2>
  </header>

    {{#if image}}
    <div class="post-thumbnail" id="{{url}}-post-thumbnail">
      <script type="text/javascript">
      var mq = window.matchMedia( "(min-width: 500px)" );
      if (mq.matches){
        var thumbnailContainer = document.getElementById('{{url}}-post-thumbnail')

        if (!String.prototype.contains) {
          String.prototype.contains = function(s) {
            return this.indexOf(s) > -1;
          }
        }

        function homepagePostThumbnail (imgUrl) {
            {{! Firesize has folded ... still looking for an alternative. }}
            // if (!imgUrl.contains("http://") && !imgUrl.contains("https://")) {
            //   fireSizeUrl = "http://firesize.com/x150/g_center/{{@blog.url}}";
            // } else {
            //   fireSizeUrl = "http://firesize.com/x150/g_center/";
            // }
            thumbnailContainer.innerHTML = '<img src="'+imgUrl+'" style="max-height: 160px;" alt="{{title}}" />';
        };
        homepagePostThumbnail("{{image}}");
      } //end mediaquery if
      </script>

    </div>
    {{/if}}
  <section itemprop="description" class="post-item-excerpt">
    <p>{{excerpt characters="80"}}<span style="color:#ccc;">â€¦</span><a class="read-more" href="{{url}}"> <span>&raquo;</span></p>
  </section>
  <footer class="post-item-footer">
    <ul class="post-item-meta-list">
      <li class="post-item-meta-item">
	    By {{author}}
      </li>
      <li class="post-item-meta-item">
        <time datetime="{{date published_at format="YYYY-MM-DD"}}" itemprop="datePublished">
          {{date published_at timeago="true"}}
        </time>
      </li>
      {{#if tags}}
        <li class="post-item-meta-item">
          {{#foreach tags}}
            <a itemprop="{{#if @first}}articleSection{{else}}keywords{{/if}}" href="{{url}}" data-pjax>{{name}}</a>
            {{~#if @last}} {{else}}, {{/if}}
          {{/foreach}}
        </li>
      {{/if}}
      <li class="post-item-meta-item">
        <a href="{{url}}#disqus_thread" data-pjax data-disqus-identifier="{{id}}">Comments</a>
      </li>
    </ul>
  </footer>
</article>
